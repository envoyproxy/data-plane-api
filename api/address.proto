syntax = "proto3";

// [V2-API-DIFF] Addresses now have .proto structure.
message Address {
  message SocketAddress {
    enum Protocol {
      TCP = 0;
    }
    Protocol protocol = 1;
    // For listeners, an empty address implies a bind to 0.0.0.0 or ::. It's
    // still possible to distinguish on address via the prefix/suffix matching
    // in FilterChainMatch after connection.
    // For clusters, an address may be either an IP or hostname to be resolved via
    // DNS.
    string address = 2;
    oneof port_specifier {
      uint32 port = 3;
      string service = 4;
    }
  }
  message Pipe {
    string path = 1;
  }
  // Support pluggable resolvers.
  message Resolver {
    // Name of the resolver. This must have been registered with Envoy.
    string name = 1;
    // TODO(htuch): Do we need further extensibility or should we collapse
    // Resolver to a string?
  }
  // If not specified, the default DNS resolver is used.
  Resolver resolver = 1;
  oneof address {
    SocketAddress socket_address = 2;
    Pipe pipe = 3;
  }
}
